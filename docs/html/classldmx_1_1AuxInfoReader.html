<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LDMX Software: ldmx::AuxInfoReader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LDMX Software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>ldmx</b>      </li>
      <li class="navelem"><a class="el" href="classldmx_1_1AuxInfoReader.html">AuxInfoReader</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">ldmx::AuxInfoReader Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="ldmx::AuxInfoReader" -->
<p>Reads auxiliary information from GDML userinfo block.  
 <a href="classldmx_1_1AuxInfoReader.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="AuxInfoReader_8h_source.html">AuxInfoReader.h</a>&gt;</code></p>

<p><a href="classldmx_1_1AuxInfoReader-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#aff0ceedad9f1a192a9280dad20d5ab6e">AuxInfoReader</a> (G4GDMLParser *parser)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#a416caab1e10e6a326ef8b9dd67876e9a">~AuxInfoReader</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#a48882cc7c826f11193ddbba02d90a200">readGlobalAuxInfo</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#a88d503f59b8b41b2ff09db6556a6cc5d">assignAuxInfoToVolumes</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1DetectorHeader.html">ldmx::DetectorHeader</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#ad1f681f54d6099e12067814908053523">getDetectorHeader</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#a841964a8b24ac088efdb769268dfa196">createSensitiveDetector</a> (G4String sdType, const G4GDMLAuxListType *auxInfoList)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#ad1beb2a851b1c666165e7cfea5a526c8">createDetectorID</a> (G4String name, const G4GDMLAuxListType *auxInfoList)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#a33623265241dd39cc2f6e367c0901b7b">createMagneticField</a> (G4String name, const G4GDMLAuxListType *auxInfoList)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#ac8f8316ab65b7567cbc57c56820414e1">createRegion</a> (G4String name, const G4GDMLAuxListType *auxInfoList)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#a3956b83ff3a55e8939fcbd065363317a">createVisAttributes</a> (G4String name, const G4GDMLAuxListType *auxInfoList)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#abdb6a716efc5964940d0eee65c22bd8a">createDetectorHeader</a> (G4String detectorVersion, const G4GDMLAuxListType *auxInfoList)</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">G4GDMLParser *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#ae5859c46ebfdc353f8074343ab1631c7">parser_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">G4GDMLEvaluator *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Reads auxiliary information from GDML userinfo block. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This class reads information to define a detector header block, sensitive detectors, visualization attributes, magnetic fields, detector IDs, and detector regions from the userinfo block of a GDML file. These objects are then assigned to the appropriate logical volumes which have <em>auxiliary</em> tags that reference these objects by name. </dd></dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8h_source.html#l00029">29</a> of file <a class="el" href="AuxInfoReader_8h_source.html">AuxInfoReader.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aff0ceedad9f1a192a9280dad20d5ab6e"></a><!-- doxytag: member="ldmx::AuxInfoReader::AuxInfoReader" ref="aff0ceedad9f1a192a9280dad20d5ab6e" args="(G4GDMLParser *parser)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::AuxInfoReader::AuxInfoReader </td>
          <td>(</td>
          <td class="paramtype">G4GDMLParser *&#160;</td>
          <td class="paramname"><em>parser</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Class constructor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">parser</td><td>The GDML parser. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00034">34</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                                                        :
            <a class="code" href="classldmx_1_1AuxInfoReader.html#ae5859c46ebfdc353f8074343ab1631c7">parser_</a>(theParser), <a class="code" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a>(<span class="keyword">new</span> G4GDMLEvaluator) {
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a416caab1e10e6a326ef8b9dd67876e9a"></a><!-- doxytag: member="ldmx::AuxInfoReader::~AuxInfoReader" ref="a416caab1e10e6a326ef8b9dd67876e9a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::AuxInfoReader::~AuxInfoReader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Class destructor. </p>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00038">38</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>References <a class="el" href="AuxInfoReader_8h_source.html#l00116">eval_</a>.</p>
<div class="fragment"><pre class="fragment">                                  {
        <span class="keyword">delete</span> <a class="code" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a>;
        <span class="keyword">delete</span> detectorHeader_;
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a88d503f59b8b41b2ff09db6556a6cc5d"></a><!-- doxytag: member="ldmx::AuxInfoReader::assignAuxInfoToVolumes" ref="a88d503f59b8b41b2ff09db6556a6cc5d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::AuxInfoReader::assignAuxInfoToVolumes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Assign auxiliary info to volumes such as sensitive detectors. </p>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00157">157</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>References <a class="el" href="VisAttributesStore_8h_source.html#l00032">ldmx::VisAttributesStore::getInstance()</a>, <a class="el" href="MagneticFieldStore_8h_source.html#l00032">ldmx::MagneticFieldStore::getInstance()</a>, <a class="el" href="MagneticFieldStore_8h_source.html#l00041">ldmx::MagneticFieldStore::getMagneticField()</a>, <a class="el" href="VisAttributesStore_8h_source.html#l00042">ldmx::VisAttributesStore::getVisAttributes()</a>, and <a class="el" href="AuxInfoReader_8h_source.html#l00111">parser_</a>.</p>

<p>Referenced by <a class="el" href="DetectorConstruction_8cxx_source.html#l00013">ldmx::DetectorConstruction::Construct()</a>.</p>
<div class="fragment"><pre class="fragment">                                               {
        <span class="keyword">const</span> G4LogicalVolumeStore* lvs = G4LogicalVolumeStore::GetInstance();
        std::vector&lt;G4LogicalVolume*&gt;::const_iterator lvciter;
        <span class="keywordflow">for</span> (lvciter = lvs-&gt;begin(); lvciter != lvs-&gt;end(); lvciter++) {
            G4GDMLAuxListType auxInfo = <a class="code" href="classldmx_1_1AuxInfoReader.html#ae5859c46ebfdc353f8074343ab1631c7">parser_</a>-&gt;GetVolumeAuxiliaryInformation(*lvciter);
            <span class="keywordflow">if</span> (auxInfo.size() &gt; 0) {

                <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfo.begin(); iaux != auxInfo.end(); iaux++) {

                    G4String auxType = iaux-&gt;type;
                    G4String auxVal = iaux-&gt;value;
                    G4String auxUnit = iaux-&gt;unit;

                    G4LogicalVolume* lv = (*lvciter);

                    <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;SensDet&quot;</span>) {
                        G4String sdName = auxVal;
                        G4VSensitiveDetector* sd = G4SDManager::GetSDMpointer()-&gt;FindSensitiveDetector(sdName);
                        <span class="keywordflow">if</span> (sd != NULL) {
                            lv-&gt;SetSensitiveDetector(sd);
                            std::cout &lt;&lt; <span class="stringliteral">&quot;Assigned SD &quot;</span> &lt;&lt; sd-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; lv-&gt;GetName() &lt;&lt; std::endl;
                        } <span class="keywordflow">else</span> {
                            std::cout &lt;&lt; <span class="stringliteral">&quot;Unknown SensDet in volume&#39;s auxiliary info: &quot;</span> &lt;&lt; sdName &lt;&lt; std::endl;
                            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The SensDet was not found.  Is it defined in userinfo?&quot;</span>);
                        }
                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;MagneticField&quot;</span>) {
                        G4String magFieldName = auxVal;
                        G4MagneticField* magField = <a class="code" href="classldmx_1_1MagneticFieldStore.html#a8d759e45078f5fb42f74e0e4995c7573">MagneticFieldStore::getInstance</a>()-&gt;getMagneticField(magFieldName);
                        <span class="keywordflow">if</span> (magField != NULL) {
                            G4FieldManager* mgr = <span class="keyword">new</span> G4FieldManager(magField);
                            lv-&gt;SetFieldManager(mgr, <span class="keyword">true</span> <span class="comment">/* FIXME: hard-coded to force field manager to daughters */</span>);
                            std::cout &lt;&lt; <span class="stringliteral">&quot;Assigned magnetic field &quot;</span> &lt;&lt; magFieldName &lt;&lt; <span class="stringliteral">&quot; to volume &quot;</span> &lt;&lt; lv-&gt;GetName() &lt;&lt; std::endl;
                        } <span class="keywordflow">else</span> {
                            std::cout &lt;&lt; <span class="stringliteral">&quot;Unknown MagneticField ref in volume&#39;s auxiliary info: &quot;</span> &lt;&lt; magFieldName &lt;&lt; std::endl;
                            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The MagneticField was not found.  Is it defined in userinfo?&quot;</span>);
                        }
                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;Region&quot;</span>) {
                        G4String regionName = auxVal;
                        G4Region* region = G4RegionStore::GetInstance()-&gt;GetRegion(regionName);
                        <span class="keywordflow">if</span> (region != NULL) {
                            region-&gt;AddRootLogicalVolume(lv);
                            std::cout &lt;&lt; <span class="stringliteral">&quot;Added volume &quot;</span> &lt;&lt; lv-&gt;GetName() &lt;&lt; <span class="stringliteral">&quot; to region &quot;</span> &lt;&lt; regionName &lt;&lt; std::endl;
                        } <span class="keywordflow">else</span> {
                            std::cerr &lt;&lt; <span class="stringliteral">&quot;Referenced region &quot;</span> &lt;&lt; regionName &lt;&lt; <span class="stringliteral">&quot; was not found!&quot;</span> &lt;&lt; std::endl;
                            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The region was not found.  Is it defined in userinfo?&quot;</span>);
                        }
                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;VisAttributes&quot;</span>) {
                        G4String visName = auxVal;
                        G4VisAttributes* visAttributes = <a class="code" href="classldmx_1_1VisAttributesStore.html#a594168ede52f88644396b9a0f21bf076">VisAttributesStore::getInstance</a>()-&gt;getVisAttributes(visName);
                        <span class="keywordflow">if</span> (visAttributes != NULL) {
                            lv-&gt;SetVisAttributes(visAttributes);
                            std::cout &lt;&lt; <span class="stringliteral">&quot;Assigned VisAttributes &quot;</span> &lt;&lt; visName &lt;&lt; <span class="stringliteral">&quot; to volume &quot;</span> &lt;&lt; lv-&gt;GetName() &lt;&lt; std::endl;
                        } <span class="keywordflow">else</span> {
                            std::cerr &lt;&lt; <span class="stringliteral">&quot;Referenced VisAttributes &quot;</span> &lt;&lt; visName &lt;&lt; <span class="stringliteral">&quot; was not found!&quot;</span> &lt;&lt; std::endl;
                            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The VisAttributes was not found.  Is it defined in userinfo?&quot;</span>);
                        }
                    }
                }
            }
        }
    }
</pre></div>
</div>
</div>
<a class="anchor" id="abdb6a716efc5964940d0eee65c22bd8a"></a><!-- doxytag: member="ldmx::AuxInfoReader::createDetectorHeader" ref="abdb6a716efc5964940d0eee65c22bd8a" args="(G4String detectorVersion, const G4GDMLAuxListType *auxInfoList)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::AuxInfoReader::createDetectorHeader </td>
          <td>(</td>
          <td class="paramtype">G4String&#160;</td>
          <td class="paramname"><em>detectorVersion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4GDMLAuxListType *&#160;</td>
          <td class="paramname"><em>auxInfoList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create the detector header from the global auxinfo. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">detectorVersion</td><td>The aux value with the detector version. </td></tr>
    <tr><td class="paramname">auxInfoList</td><td>The aux info with the detector header information. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00463">463</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>Referenced by <a class="el" href="AuxInfoReader_8cxx_source.html#l00043">readGlobalAuxInfo()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                    {

        <span class="keywordtype">int</span> detectorVersion = atoi(auxValue.c_str());

        std::string detectorName(<span class="stringliteral">&quot;&quot;</span>);
        std::string author(<span class="stringliteral">&quot;&quot;</span>);
        std::string description(<span class="stringliteral">&quot;&quot;</span>);

        <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfoList-&gt;begin(); iaux != auxInfoList-&gt;end(); iaux++) {

            G4String auxType = iaux-&gt;type;
            G4String auxVal = iaux-&gt;value;
            G4String auxUnit = iaux-&gt;unit;

            <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;DetectorName&quot;</span>) {
                detectorName = auxVal;
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;Author&quot;</span>) {
                author = auxVal;
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;Description&quot;</span>) {
                description = auxVal;
            }
        }

        detectorHeader_ = <span class="keyword">new</span> DetectorHeader(detectorName, detectorVersion, description, author);

        std::cout &lt;&lt; std::endl;
        std::cout &lt;&lt; <span class="stringliteral">&quot;Read detector header from userinfo: &quot;</span> &lt;&lt; std::endl;
        std::cout &lt;&lt; <span class="stringliteral">&quot;  DetectorName: &quot;</span> &lt;&lt; detectorHeader_-&gt;getName() &lt;&lt; std::endl;
        std::cout &lt;&lt; <span class="stringliteral">&quot;  DetectorVersion: &quot;</span> &lt;&lt; detectorHeader_-&gt;getVersion() &lt;&lt; std::endl;
        std::cout &lt;&lt; <span class="stringliteral">&quot;  Author: &quot;</span> &lt;&lt; detectorHeader_-&gt;getAuthor() &lt;&lt; std::endl;
        std::cout &lt;&lt; <span class="stringliteral">&quot;  Description: &quot;</span> &lt;&lt; detectorHeader_-&gt;getDescription() &lt;&lt; std::endl;
        std::cout &lt;&lt; std::endl;

    }
</pre></div>
</div>
</div>
<a class="anchor" id="ad1beb2a851b1c666165e7cfea5a526c8"></a><!-- doxytag: member="ldmx::AuxInfoReader::createDetectorID" ref="ad1beb2a851b1c666165e7cfea5a526c8" args="(G4String name, const G4GDMLAuxListType *auxInfoList)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::AuxInfoReader::createDetectorID </td>
          <td>(</td>
          <td class="paramtype">G4String&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4GDMLAuxListType *&#160;</td>
          <td class="paramname"><em>auxInfoList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a detector ID from GDML data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the detector ID. </td></tr>
    <tr><td class="paramname">auxInfoList</td><td>The aux info defining the detector ID. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00219">219</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>References <a class="el" href="DetectorIDStore_8h_source.html#l00050">ldmx::DetectorIDStore::addID()</a>, and <a class="el" href="DetectorIDStore_8h_source.html#l00032">ldmx::DetectorIDStore::getInstance()</a>.</p>

<p>Referenced by <a class="el" href="AuxInfoReader_8cxx_source.html#l00043">readGlobalAuxInfo()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                              {

        std::cout &lt;&lt; <span class="stringliteral">&quot;Creating DetectorID &quot;</span> &lt;&lt; idName &lt;&lt; std::endl;
        <a class="code" href="classldmx_1_1IDField.html#a93890d8859b0818e939e96d9d1348cad">IDField::IDFieldList</a>* fieldList = <span class="keyword">new</span> <a class="code" href="classldmx_1_1IDField.html#a93890d8859b0818e939e96d9d1348cad">IDField::IDFieldList</a>();

        <span class="comment">// iterate fields</span>
        <span class="keywordtype">int</span> fieldIndex = 0;
        <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator fieldIt = auxInfoList-&gt;begin(); fieldIt != auxInfoList-&gt;end(); fieldIt++) {

            std::vector&lt;G4GDMLAuxStructType&gt;* fieldsAux = fieldIt-&gt;auxList;

            G4String auxType = fieldIt-&gt;type;
            G4String auxVal = fieldIt-&gt;value;

            <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;IDField&quot;</span>) {

                <span class="keywordtype">string</span> fieldName = auxVal;

                std::cout &lt;&lt; <span class="stringliteral">&quot;Creating IDField &quot;</span> &lt;&lt; fieldName &lt;&lt; std::endl;

                <span class="keywordtype">int</span> startBit, endBit = -1;

                <span class="comment">// iterate field aux values</span>
                <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator fieldValsIt = fieldsAux-&gt;begin(); fieldValsIt != fieldsAux-&gt;end(); fieldValsIt++) {

                    G4String fieldValAuxType = fieldValsIt-&gt;type;
                    G4String fieldValAuxValue = fieldValsIt-&gt;value;

                    <span class="keywordflow">if</span> (fieldValAuxType == <span class="stringliteral">&quot;StartBit&quot;</span>) {
                        startBit = atoi(fieldValAuxValue.c_str());
                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fieldValAuxType == <span class="stringliteral">&quot;EndBit&quot;</span>) {
                        endBit = atoi(fieldValAuxValue.c_str());
                    }
                }

                <span class="keywordflow">if</span> (startBit == -1) {
                    G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The DetectorID is missing the StartBit.&quot;</span>);
                }

                <span class="keywordflow">if</span> (endBit == -1) {
                    G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The DetectorID is missing the EndBit.&quot;</span>);
                }

                fieldList-&gt;push_back(<span class="keyword">new</span> IDField(fieldName, fieldIndex, startBit, endBit));

                std::cout &lt;&lt; <span class="stringliteral">&quot;Added IDField &quot;</span> &lt;&lt; fieldName &lt;&lt; <span class="stringliteral">&quot; with StartBit = &quot;</span> &lt;&lt; startBit &lt;&lt; <span class="stringliteral">&quot;, EndBit = &quot;</span> &lt;&lt; endBit &lt;&lt; <span class="stringliteral">&quot;, Index = &quot;</span> &lt;&lt; fieldIndex &lt;&lt; std::endl;

                <span class="comment">// Increment field index which is assigned automatically based on element ordering.</span>
                fieldIndex++;
            }
        }

        <a class="code" href="classldmx_1_1DetectorID.html" title="Defines a 32-bit packed ID for uniquely identifying hits and detector components.">DetectorID</a>* <span class="keywordtype">id</span> = <span class="keyword">new</span> <a class="code" href="classldmx_1_1DetectorID.html" title="Defines a 32-bit packed ID for uniquely identifying hits and detector components.">DetectorID</a>(fieldList);
        <a class="code" href="classldmx_1_1DetectorIDStore.html#a34b6239f85edf4585da5b30af48e27ec">DetectorIDStore::getInstance</a>()-&gt;addID(idName, <span class="keywordtype">id</span>);
        std::cout &lt;&lt; <span class="stringliteral">&quot;Created detector ID &quot;</span> &lt;&lt; idName &lt;&lt; std::endl &lt;&lt; std::endl;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a33623265241dd39cc2f6e367c0901b7b"></a><!-- doxytag: member="ldmx::AuxInfoReader::createMagneticField" ref="a33623265241dd39cc2f6e367c0901b7b" args="(G4String name, const G4GDMLAuxListType *auxInfoList)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::AuxInfoReader::createMagneticField </td>
          <td>(</td>
          <td class="paramtype">G4String&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4GDMLAuxListType *&#160;</td>
          <td class="paramname"><em>auxInfoList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a magnetic field from GDML data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the magnetic field. </td></tr>
    <tr><td class="paramname">auxInfoList</td><td>The aux info defining the magnetic field. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00276">276</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>References <a class="el" href="MagneticFieldStore_8h_source.html#l00050">ldmx::MagneticFieldStore::addMagneticField()</a>, <a class="el" href="AuxInfoReader_8h_source.html#l00116">eval_</a>, and <a class="el" href="MagneticFieldStore_8h_source.html#l00032">ldmx::MagneticFieldStore::getInstance()</a>.</p>

<p>Referenced by <a class="el" href="AuxInfoReader_8cxx_source.html#l00043">readGlobalAuxInfo()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                       {

        <span class="comment">// Find type of the mag field.</span>
        G4String magFieldType(<span class="stringliteral">&quot;&quot;</span>);
        <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfoList-&gt;begin(); iaux != auxInfoList-&gt;end(); iaux++) {

            G4String auxType = iaux-&gt;type;
            G4String auxVal = iaux-&gt;value;

            <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;MagneticFieldType&quot;</span>) {
                magFieldType = auxVal;
                <span class="keywordflow">break</span>;
            }
        }

        <span class="keywordflow">if</span> (magFieldType == <span class="stringliteral">&quot;&quot;</span>) {
            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;Missing MagFieldType for magnetic field definition.&quot;</span>);
        }

        G4MagneticField* magField = NULL;

        <span class="comment">// Create a uniform mag field using the built-in Geant4 type.</span>
        <span class="keywordflow">if</span> (magFieldType == <span class="stringliteral">&quot;G4UniformMagField&quot;</span>) {
            string::size_type sz;
            <span class="keywordtype">double</span> bx, by, bz;
            bx = by = bz = 0.;
            <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfoList-&gt;begin(); iaux != auxInfoList-&gt;end(); iaux++) {

                G4String auxType = iaux-&gt;type;
                G4String auxVal = iaux-&gt;value;
                G4String auxUnit = iaux-&gt;unit;

                G4String expr = auxVal + <span class="stringliteral">&quot;*&quot;</span> + auxUnit;
                <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;bx&quot;</span>) {
                    bx = <a class="code" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a>-&gt;Evaluate(expr);
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;by&quot;</span>) {
                    by = <a class="code" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a>-&gt;Evaluate(expr);
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;bz&quot;</span>) {
                    bz = <a class="code" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a>-&gt;Evaluate(expr);
                }
            }
            G4ThreeVector fieldComponents(bx, by, bz);
            magField = <span class="keyword">new</span> G4UniformMagField(fieldComponents);

            std::cout &lt;&lt; <span class="stringliteral">&quot;Created G4UniformMagField &quot;</span> &lt;&lt; magFieldName &lt;&lt; <span class="stringliteral">&quot; with field components &quot;</span> &lt;&lt; fieldComponents &lt;&lt; std::endl &lt;&lt; std::endl;

            <span class="comment">// Create a global 3D field map by reading from a data file.</span>
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (magFieldType == <span class="stringliteral">&quot;MagneticFieldMap3D&quot;</span>) {

            <span class="keywordtype">string</span> fileName;
            <span class="keywordtype">double</span> offsetX, offsetY, offsetZ;

            <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfoList-&gt;begin(); iaux != auxInfoList-&gt;end(); iaux++) {

                G4String auxType = iaux-&gt;type;
                G4String auxVal = iaux-&gt;value;
                G4String auxUnit = iaux-&gt;unit;

                G4String expr = auxVal + <span class="stringliteral">&quot;*&quot;</span> + auxUnit;

                <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;File&quot;</span>) {
                    fileName = auxVal;
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;OffsetX&quot;</span>) {
                    offsetX = <a class="code" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a>-&gt;Evaluate(expr);
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;OffsetY&quot;</span>) {
                    offsetY = <a class="code" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a>-&gt;Evaluate(expr);
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;OffsetZ&quot;</span>) {
                    offsetZ = <a class="code" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">eval_</a>-&gt;Evaluate(expr);
                }
            }

            <span class="keywordflow">if</span> (fileName.size() == 0) {
                G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;File info with field data was not provided.&quot;</span>);
            }

            <span class="comment">// Create new 3D field map.</span>
            G4MagneticField* fieldMap = <span class="keyword">new</span> MagneticFieldMap3D(fileName.c_str(), offsetX, offsetY, offsetZ);

            <span class="comment">// Assign field map as global field.</span>
            G4FieldManager* fieldMgr = G4TransportationManager::GetTransportationManager()-&gt;GetFieldManager();
            <span class="keywordflow">if</span> (fieldMgr-&gt;GetDetectorField() != <span class="keyword">nullptr</span>) {
                G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;Global mag field was already assigned.&quot;</span>);
            }
            fieldMgr-&gt;SetDetectorField(fieldMap);
            fieldMgr-&gt;CreateChordFinder(fieldMap);

        } <span class="keywordflow">else</span> {
            std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown MagFieldType in auxiliary info: &quot;</span> &lt;&lt; magFieldType &lt;&lt; std::endl;
            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;Unknown MagFieldType in auxiliary info.&quot;</span>);
        }

        <a class="code" href="classldmx_1_1MagneticFieldStore.html#a8d759e45078f5fb42f74e0e4995c7573">MagneticFieldStore::getInstance</a>()-&gt;addMagneticField(magFieldName, magField);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ac8f8316ab65b7567cbc57c56820414e1"></a><!-- doxytag: member="ldmx::AuxInfoReader::createRegion" ref="ac8f8316ab65b7567cbc57c56820414e1" args="(G4String name, const G4GDMLAuxListType *auxInfoList)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::AuxInfoReader::createRegion </td>
          <td>(</td>
          <td class="paramtype">G4String&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4GDMLAuxListType *&#160;</td>
          <td class="paramname"><em>auxInfoList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a detector region from GDML data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the detector region. </td></tr>
    <tr><td class="paramname">auxInfoList</td><td>The aux info defining the detector region. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00370">370</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>Referenced by <a class="el" href="AuxInfoReader_8cxx_source.html#l00043">readGlobalAuxInfo()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                        {

        <span class="keywordtype">bool</span> storeTrajectories = <span class="keyword">true</span>;
        <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfoList-&gt;begin(); iaux != auxInfoList-&gt;end(); iaux++) {

            G4String auxType = iaux-&gt;type;
            G4String auxVal = iaux-&gt;value;
            G4String auxUnit = iaux-&gt;unit;

            <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;StoreTrajectories&quot;</span>) {
                <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;false&quot;</span>) {
                    storeTrajectories = <span class="keyword">false</span>;
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;true&quot;</span>) {
                    storeTrajectories = <span class="keyword">true</span>;
                }
            }
        }

        G4VUserRegionInformation* regionInfo = <span class="keyword">new</span> UserRegionInformation(storeTrajectories);
        G4Region* region = <span class="keyword">new</span> G4Region(name);
        region-&gt;SetUserInformation(regionInfo);

        std::cout &lt;&lt; <span class="stringliteral">&quot;Created new detector region &quot;</span> &lt;&lt; region-&gt;GetName() &lt;&lt; std::endl &lt;&lt; std::endl;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a841964a8b24ac088efdb769268dfa196"></a><!-- doxytag: member="ldmx::AuxInfoReader::createSensitiveDetector" ref="a841964a8b24ac088efdb769268dfa196" args="(G4String sdType, const G4GDMLAuxListType *auxInfoList)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::AuxInfoReader::createSensitiveDetector </td>
          <td>(</td>
          <td class="paramtype">G4String&#160;</td>
          <td class="paramname"><em>sdType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4GDMLAuxListType *&#160;</td>
          <td class="paramname"><em>auxInfoList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a sensitive detector from GDML data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sdType</td><td>The type of the sensitive detector. </td></tr>
    <tr><td class="paramname">auxInfoList</td><td>The aux info defining the sensitive detector. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00069">69</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>References <a class="el" href="DetectorIDStore_8h_source.html#l00041">ldmx::DetectorIDStore::getID()</a>, and <a class="el" href="DetectorIDStore_8h_source.html#l00032">ldmx::DetectorIDStore::getInstance()</a>.</p>

<p>Referenced by <a class="el" href="AuxInfoReader_8cxx_source.html#l00043">readGlobalAuxInfo()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                                             {

        std::cout &lt;&lt; <span class="stringliteral">&quot;Creating SensitiveDetector &quot;</span> &lt;&lt; theSensDetName &lt;&lt; std::endl;

        G4String sdType(<span class="stringliteral">&quot;&quot;</span>);
        G4String hcName(<span class="stringliteral">&quot;&quot;</span>);
        G4String idName(<span class="stringliteral">&quot;&quot;</span>);
        <span class="keywordtype">int</span> subdetID = -1;
        <span class="keywordtype">int</span> layerDepth = -1;
        <span class="keywordtype">int</span> verbose = 0;
        <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfoList-&gt;begin(); iaux != auxInfoList-&gt;end(); iaux++) {

            G4String auxType = iaux-&gt;type;
            G4String auxVal = iaux-&gt;value;
            G4String auxUnit = iaux-&gt;unit;

            std::cout &lt;&lt; <span class="stringliteral">&quot;auxType: &quot;</span> &lt;&lt; auxType &lt;&lt; <span class="stringliteral">&quot;, auxVal: &quot;</span> &lt;&lt; auxVal &lt;&lt; <span class="stringliteral">&quot;, auxUnit: &quot;</span> &lt;&lt; auxUnit &lt;&lt; std::endl;

            <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;SensDetType&quot;</span>) {
                sdType = auxVal;
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;HitsCollection&quot;</span>) {
                hcName = auxVal;
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;Verbose&quot;</span>) {
                verbose = atoi(auxVal.c_str());
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;SubdetID&quot;</span>) {
                subdetID = atoi(auxVal.c_str());
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;DetectorID&quot;</span>) {
                idName = auxVal;
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;LayerDepth&quot;</span>) {
                layerDepth = atoi(auxVal.c_str());
            }
        }

        <span class="keywordflow">if</span> (sdType == <span class="stringliteral">&quot;&quot;</span>) {
            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The SensDet is missing the SensDetType.&quot;</span>);
        }

        <span class="keywordflow">if</span> (hcName == <span class="stringliteral">&quot;&quot;</span>) {
            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The SensDet is missing the HitsCollection.&quot;</span>);
        }

        <span class="keywordflow">if</span> (subdetID &lt;= 0) {
            std::cerr &lt;&lt; <span class="stringliteral">&quot;Bad SubdetID: &quot;</span> &lt;&lt; subdetID &lt;&lt; std::endl;
            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The SubdetID is missing or has an invalid value.&quot;</span>);
        }

        <span class="comment">/*</span>
<span class="comment">         * Use the default detector ID or create one from information supplied in the userinfo block, if present.</span>
<span class="comment">         */</span>
        <a class="code" href="classldmx_1_1DetectorID.html" title="Defines a 32-bit packed ID for uniquely identifying hits and detector components.">DetectorID</a>* detID = <span class="keyword">new</span> DefaultDetectorID();
        <span class="keywordflow">if</span> (idName != <span class="stringliteral">&quot;&quot;</span>) {
            detID = <a class="code" href="classldmx_1_1DetectorIDStore.html#a34b6239f85edf4585da5b30af48e27ec">DetectorIDStore::getInstance</a>()-&gt;getID(idName);
            <span class="keywordflow">if</span> (!detID) {
                std::cerr &lt;&lt; <span class="stringliteral">&quot;The Detector ID&quot;</span> &lt;&lt; idName &lt;&lt; <span class="stringliteral">&quot; does not exist.  Is it defined before the SensDet in userinfo?&quot;</span> &lt;&lt; std::endl;
                G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;The referenced Detector ID was not found.&quot;</span>);
            }
        }
        <span class="comment">/*</span>
<span class="comment">         * Build the Sensitive Detector, and re-assign the detID if applicable</span>
<span class="comment">         */</span>
        G4VSensitiveDetector* sd = 0;

        <span class="keywordflow">if</span> (sdType == <span class="stringliteral">&quot;TrackerSD&quot;</span>) {
            sd = <span class="keyword">new</span> TrackerSD(theSensDetName, hcName, subdetID, detID);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sdType == <span class="stringliteral">&quot;EcalSD&quot;</span>) {
            detID = <span class="keyword">new</span> EcalDetectorID();
            sd = <span class="keyword">new</span> EcalSD(theSensDetName, hcName, subdetID, detID);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sdType == <span class="stringliteral">&quot;HcalSD&quot;</span>) {
            sd = <span class="keyword">new</span> HcalSD(theSensDetName, hcName, subdetID, detID);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sdType == <span class="stringliteral">&quot;CalorimeterSD&quot;</span>) {
            sd = <span class="keyword">new</span> CalorimeterSD(theSensDetName, hcName, subdetID, detID);
        } <span class="keywordflow">else</span> {
            std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown SensitiveDetector type: &quot;</span> &lt;&lt; sdType &lt;&lt; std::endl;
            G4Exception(<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, FatalException, <span class="stringliteral">&quot;Unknown SensitiveDetector type in aux info.&quot;</span>);
        }

        <span class="comment">/*</span>
<span class="comment">         * Fix  layer depth if the Sensitive Detector is not the Tracker</span>
<span class="comment">         */</span>
        <span class="keywordflow">if</span> (sdType != <span class="stringliteral">&quot;TrackerSD&quot;</span> &amp;&amp; layerDepth != -1) {
            ((CalorimeterSD*) sd)-&gt;setLayerDepth(layerDepth);
            std::cout &lt;&lt; <span class="stringliteral">&quot;Layer depth set to &quot;</span> &lt;&lt; layerDepth &lt;&lt; std::endl;
        }
        sd-&gt;SetVerboseLevel(verbose);

        std::cout &lt;&lt; <span class="stringliteral">&quot;Created &quot;</span> &lt;&lt; sdType &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; theSensDetName &lt;&lt; <span class="stringliteral">&quot; with hits collection &quot;</span> &lt;&lt; hcName &lt;&lt; <span class="stringliteral">&quot; and verbose level &quot;</span> &lt;&lt; verbose &lt;&lt; std::endl &lt;&lt; std::endl;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a3956b83ff3a55e8939fcbd065363317a"></a><!-- doxytag: member="ldmx::AuxInfoReader::createVisAttributes" ref="a3956b83ff3a55e8939fcbd065363317a" args="(G4String name, const G4GDMLAuxListType *auxInfoList)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::AuxInfoReader::createVisAttributes </td>
          <td>(</td>
          <td class="paramtype">G4String&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4GDMLAuxListType *&#160;</td>
          <td class="paramname"><em>auxInfoList</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create visualization attributes from GDML data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>The name of the visualization attributes. </td></tr>
    <tr><td class="paramname">auxInfoList</td><td>The aux info defining the visualization attributes. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00395">395</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>References <a class="el" href="VisAttributesStore_8h_source.html#l00051">ldmx::VisAttributesStore::addVisAttributes()</a>, and <a class="el" href="VisAttributesStore_8h_source.html#l00032">ldmx::VisAttributesStore::getInstance()</a>.</p>

<p>Referenced by <a class="el" href="AuxInfoReader_8cxx_source.html#l00043">readGlobalAuxInfo()</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                               {

        G4double rgba[4] = {1., 1., 1., 1.};
        G4bool visible = <span class="keyword">true</span>;
        G4bool dauInvisible = <span class="keyword">false</span>;
        G4bool forceWireframe = <span class="keyword">false</span>;
        G4bool forceSolid = <span class="keyword">false</span>;
        G4double lineWidth = 1.0;
        G4VisAttributes::LineStyle lineStyle = G4VisAttributes::unbroken;

        <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfoList-&gt;begin(); iaux != auxInfoList-&gt;end(); iaux++) {

            G4String auxType = iaux-&gt;type;
            G4String auxVal = iaux-&gt;value;
            G4String auxUnit = iaux-&gt;unit;

            <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;R&quot;</span>) {
                rgba[0] = atof(auxVal.c_str());
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;G&quot;</span>) {
                rgba[1] = atof(auxVal.c_str());
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;B&quot;</span>) {
                rgba[2] = atof(auxVal.c_str());
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;A&quot;</span>) {
                rgba[3] = atof(auxVal.c_str());
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;Style&quot;</span>) {
                <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;wireframe&quot;</span>) {
                    forceWireframe = <span class="keyword">true</span>;
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;solid&quot;</span>) {
                    forceSolid = <span class="keyword">true</span>;
                }
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;DaughtersInvisible&quot;</span>) {
                <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;true&quot;</span>) {
                    dauInvisible = <span class="keyword">true</span>;
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;false&quot;</span>) {
                    dauInvisible = <span class="keyword">false</span>;
                }
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;Visible&quot;</span>) {
                <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;true&quot;</span>) {
                    visible = <span class="keyword">true</span>;
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;false&quot;</span>) {
                    visible = <span class="keyword">false</span>;
                }
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;LineStyle&quot;</span>) {
                <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;unbroken&quot;</span>) {
                    lineStyle = G4VisAttributes::unbroken;
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;dashed&quot;</span>) {
                    lineStyle = G4VisAttributes::dashed;
                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxVal == <span class="stringliteral">&quot;dotted&quot;</span>) {
                    lineStyle = G4VisAttributes::dotted;
                }
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;LineWidth&quot;</span>) {
                lineWidth = atof(auxVal.c_str());
            }
        }

        G4VisAttributes* visAttributes = <span class="keyword">new</span> G4VisAttributes();
        visAttributes-&gt;SetColor(rgba[0], rgba[1], rgba[2], rgba[3]);
        visAttributes-&gt;SetVisibility(visible);
        visAttributes-&gt;SetDaughtersInvisible(dauInvisible);
        visAttributes-&gt;SetForceWireframe(forceWireframe);
        visAttributes-&gt;SetForceSolid(forceSolid);
        visAttributes-&gt;SetLineWidth(lineWidth);
        visAttributes-&gt;SetLineStyle(lineStyle);
        <a class="code" href="classldmx_1_1VisAttributesStore.html#a594168ede52f88644396b9a0f21bf076">VisAttributesStore::getInstance</a>()-&gt;addVisAttributes(name, visAttributes);

        std::cout &lt;&lt; <span class="stringliteral">&quot;Created VisAttributes &quot;</span> &lt;&lt; name &lt;&lt; std::endl &lt;&lt; (*visAttributes) &lt;&lt; std::endl &lt;&lt; std::endl;
    }
</pre></div>
</div>
</div>
<a class="anchor" id="ad1f681f54d6099e12067814908053523"></a><!-- doxytag: member="ldmx::AuxInfoReader::getDetectorHeader" ref="ad1f681f54d6099e12067814908053523" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classldmx_1_1DetectorHeader.html">ldmx::DetectorHeader</a>* ldmx::AuxInfoReader::getDetectorHeader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the detector header that was created from the userinfo block. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>The detector header. </dd></dl>

<p>Definition at line <a class="el" href="AuxInfoReader_8h_source.html#l00058">58</a> of file <a class="el" href="AuxInfoReader_8h_source.html">AuxInfoReader.h</a>.</p>

<p>Referenced by <a class="el" href="DetectorConstruction_8h_source.html#l00065">ldmx::DetectorConstruction::getDetectorHeader()</a>.</p>
<div class="fragment"><pre class="fragment">                                                    {
                <span class="keywordflow">return</span> detectorHeader_;
            }
</pre></div>
</div>
</div>
<a class="anchor" id="a48882cc7c826f11193ddbba02d90a200"></a><!-- doxytag: member="ldmx::AuxInfoReader::readGlobalAuxInfo" ref="a48882cc7c826f11193ddbba02d90a200" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::AuxInfoReader::readGlobalAuxInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Read the global auxiliary information from the auxinfo block. </p>

<p>Definition at line <a class="el" href="AuxInfoReader_8cxx_source.html#l00043">43</a> of file <a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a>.</p>

<p>References <a class="el" href="AuxInfoReader_8cxx_source.html#l00463">createDetectorHeader()</a>, <a class="el" href="AuxInfoReader_8cxx_source.html#l00219">createDetectorID()</a>, <a class="el" href="AuxInfoReader_8cxx_source.html#l00276">createMagneticField()</a>, <a class="el" href="AuxInfoReader_8cxx_source.html#l00370">createRegion()</a>, <a class="el" href="AuxInfoReader_8cxx_source.html#l00069">createSensitiveDetector()</a>, <a class="el" href="AuxInfoReader_8cxx_source.html#l00395">createVisAttributes()</a>, and <a class="el" href="AuxInfoReader_8h_source.html#l00111">parser_</a>.</p>

<p>Referenced by <a class="el" href="DetectorConstruction_8cxx_source.html#l00013">ldmx::DetectorConstruction::Construct()</a>.</p>
<div class="fragment"><pre class="fragment">                                          {

        <span class="keyword">const</span> G4GDMLAuxListType* auxInfoList = <a class="code" href="classldmx_1_1AuxInfoReader.html#ae5859c46ebfdc353f8074343ab1631c7">parser_</a>-&gt;GetAuxList();
        <span class="keywordflow">for</span> (std::vector&lt;G4GDMLAuxStructType&gt;::const_iterator iaux = auxInfoList-&gt;begin(); iaux != auxInfoList-&gt;end(); iaux++) {

            G4String auxType = iaux-&gt;type;
            G4String auxVal = iaux-&gt;value;
            G4String auxUnit = iaux-&gt;unit;

            <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;SensDet&quot;</span>) {
                <a class="code" href="classldmx_1_1AuxInfoReader.html#a841964a8b24ac088efdb769268dfa196">createSensitiveDetector</a>(auxVal, iaux-&gt;auxList);
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;DetectorID&quot;</span>) {
                <a class="code" href="classldmx_1_1AuxInfoReader.html#ad1beb2a851b1c666165e7cfea5a526c8">createDetectorID</a>(auxVal, iaux-&gt;auxList);
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;MagneticField&quot;</span>) {
                <a class="code" href="classldmx_1_1AuxInfoReader.html#a33623265241dd39cc2f6e367c0901b7b">createMagneticField</a>(auxVal, iaux-&gt;auxList);
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;Region&quot;</span>) {
                <a class="code" href="classldmx_1_1AuxInfoReader.html#ac8f8316ab65b7567cbc57c56820414e1">createRegion</a>(auxVal, iaux-&gt;auxList);
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;VisAttributes&quot;</span>) {
                <a class="code" href="classldmx_1_1AuxInfoReader.html#a3956b83ff3a55e8939fcbd065363317a">createVisAttributes</a>(auxVal, iaux-&gt;auxList);
            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (auxType == <span class="stringliteral">&quot;DetectorVersion&quot;</span>) {
                <a class="code" href="classldmx_1_1AuxInfoReader.html#abdb6a716efc5964940d0eee65c22bd8a">createDetectorHeader</a>(auxVal, iaux-&gt;auxList);
            }
        }
        <span class="keywordflow">return</span>;
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ab509aa742e7a949816cd749f8801afc4"></a><!-- doxytag: member="ldmx::AuxInfoReader::eval_" ref="ab509aa742e7a949816cd749f8801afc4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4GDMLEvaluator* <a class="el" href="classldmx_1_1AuxInfoReader.html#ab509aa742e7a949816cd749f8801afc4">ldmx::AuxInfoReader::eval_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The GDML expression evaluator. </p>

<p>Definition at line <a class="el" href="AuxInfoReader_8h_source.html#l00116">116</a> of file <a class="el" href="AuxInfoReader_8h_source.html">AuxInfoReader.h</a>.</p>

<p>Referenced by <a class="el" href="AuxInfoReader_8cxx_source.html#l00276">createMagneticField()</a>, and <a class="el" href="AuxInfoReader_8cxx_source.html#l00038">~AuxInfoReader()</a>.</p>

</div>
</div>
<a class="anchor" id="ae5859c46ebfdc353f8074343ab1631c7"></a><!-- doxytag: member="ldmx::AuxInfoReader::parser_" ref="ae5859c46ebfdc353f8074343ab1631c7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4GDMLParser* <a class="el" href="classldmx_1_1AuxInfoReader.html#ae5859c46ebfdc353f8074343ab1631c7">ldmx::AuxInfoReader::parser_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The GDML parser. </p>

<p>Definition at line <a class="el" href="AuxInfoReader_8h_source.html#l00111">111</a> of file <a class="el" href="AuxInfoReader_8h_source.html">AuxInfoReader.h</a>.</p>

<p>Referenced by <a class="el" href="AuxInfoReader_8cxx_source.html#l00157">assignAuxInfoToVolumes()</a>, and <a class="el" href="AuxInfoReader_8cxx_source.html#l00043">readGlobalAuxInfo()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>SimApplication/include/SimApplication/<a class="el" href="AuxInfoReader_8h_source.html">AuxInfoReader.h</a></li>
<li>SimApplication/src/<a class="el" href="AuxInfoReader_8cxx_source.html">AuxInfoReader.cxx</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
