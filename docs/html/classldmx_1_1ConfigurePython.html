<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LDMX Software: ldmx::ConfigurePython Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LDMX Software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>ldmx</b>      </li>
      <li class="navelem"><a class="el" href="classldmx_1_1ConfigurePython.html">ConfigurePython</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">ldmx::ConfigurePython Class Reference</div>  </div>
</div>
<div class="contents">
<!-- doxytag: class="ldmx::ConfigurePython" -->
<p>Utility class which reads/executes a python script and creates a <a class="el" href="classldmx_1_1Process.html" title="Class which represents the process under execution.">Process</a> object based on the input.  
 <a href="classldmx_1_1ConfigurePython.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>&gt;</code></p>

<p><a href="classldmx_1_1ConfigurePython-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structldmx_1_1ConfigurePython_1_1ProcessorInfo.html">ProcessorInfo</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents the configuration of an <a class="el" href="classldmx_1_1EventProcessor.html" title="Base class for all event processing components.">EventProcessor</a> in the job.  <a href="structldmx_1_1ConfigurePython_1_1ProcessorInfo.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#a4f9e289005ebe9a4e366efe2e227c390">ConfigurePython</a> (const std::string &amp;pythonScript, char *args[], int nargs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#a8faf714491e50cdaac51adfea5991ccd">~ConfigurePython</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1Process.html">Process</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#a16c95925a35f1621496d84f2b9ff271f">makeProcess</a> ()</td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#acc7e183a3417d290890d47476ab50aa8">passname_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#a03862dd75f2260a683cd8cb754c0ce1e">inputFiles_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#a638ec8a4db7ace29c62e773395b63d36">keepRules_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#ac92502918c7289b51e9189f2077ca7c5">libraries_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#a9ec35dcf8f1908874a1b784697b250c6">outputFiles_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#ab733492c9ebe4dfbe7d57f9b3366156a">histoOutFile_</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structldmx_1_1ConfigurePython_1_1ProcessorInfo.html">ProcessorInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1ConfigurePython.html#a448506b08fdb4551c0051250d28f6127">sequence_</a></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Utility class which reads/executes a python script and creates a <a class="el" href="classldmx_1_1Process.html" title="Class which represents the process under execution.">Process</a> object based on the input. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>The configuration language is documented in the overall Framework package documentation. </dd></dl>

<p>Definition at line <a class="el" href="ConfigurePython_8h_source.html#l00026">26</a> of file <a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>.</p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a4f9e289005ebe9a4e366efe2e227c390"></a><!-- doxytag: member="ldmx::ConfigurePython::ConfigurePython" ref="a4f9e289005ebe9a4e366efe2e227c390" args="(const std::string &amp;pythonScript, char *args[], int nargs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::ConfigurePython::ConfigurePython </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pythonScript</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>args</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Class constructor.</p>
<p>This method contains all the parsing and execution of the python script.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">pythonScript</td><td>Filename location of the python script. </td></tr>
    <tr><td class="paramname">args</td><td>Commandline arguments to be passed to the python script. </td></tr>
    <tr><td class="paramname">nargs</td><td>Number of commandline arguments. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="ConfigurePython_8cxx_source.html#l00034">34</a> of file <a class="el" href="ConfigurePython_8cxx_source.html">ConfigurePython.cxx</a>.</p>

<p>References <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, <a class="el" href="ConfigurePython_8h_source.html#l00072">histoOutFile_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00057">inputFiles_</a>, <a class="el" href="ParameterSet_8cxx_source.html#l00006">ldmx::ParameterSet::insert()</a>, <a class="el" href="ConfigurePython_8h_source.html#l00066">keepRules_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00068">libraries_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00070">outputFiles_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00054">passname_</a>, and <a class="el" href="ConfigurePython_8h_source.html#l00085">sequence_</a>.</p>
<div class="fragment"><pre class="fragment">                                                                                           {
        std::string path(<span class="stringliteral">&quot;.&quot;</span>);
        std::string cmd = pythonScript;

        <span class="comment">// if a path was specified, get that out</span>
        <span class="keywordflow">if</span> (pythonScript.rfind(<span class="stringliteral">&quot;/&quot;</span>) != std::string::npos) {
            path = pythonScript.substr(0, pythonScript.rfind(<span class="stringliteral">&quot;/&quot;</span>));
            cmd = pythonScript.substr(pythonScript.rfind(<span class="stringliteral">&quot;/&quot;</span>) + 1);
        }
        cmd = cmd.substr(0, cmd.find(<span class="stringliteral">&quot;.py&quot;</span>));

        Py_Initialize();
        <span class="keywordflow">if</span> (nargs &gt; 0) {
            <span class="keywordtype">char</span>** targs = <span class="keyword">new</span> <span class="keywordtype">char</span>*[nargs + 1];
            targs[0] = (<span class="keywordtype">char</span>*) pythonScript.c_str();
            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nargs; i++)
                targs[i + 1] = args[i];
            PySys_SetArgvEx(nargs, targs, 1);
            <span class="keyword">delete</span>[] targs;
        }

        PyObject* script, *temp, *process, *pMain, *pylist;
        temp = PyString_FromString(cmd.c_str());
        script = PyImport_ImportModule(cmd.c_str());
        Py_DECREF(temp);

        <span class="keywordflow">if</span> (script == 0) {
            PyErr_Print();
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ConfigureError&quot;</span>, <span class="stringliteral">&quot;Problem loading python script&quot;</span>);
        }

        PyObject* pCMod = PyObject_GetAttrString(script, <span class="stringliteral">&quot;ldmxcfg&quot;</span>);
        <span class="keywordflow">if</span> (pCMod == 0) {
            PyErr_Print();
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ConfigureError&quot;</span>, <span class="stringliteral">&quot;Problem loading python script&quot;</span>);
        }
        PyObject* pProcessClass = PyObject_GetAttrString(pCMod, <span class="stringliteral">&quot;Process&quot;</span>);
        Py_DECREF(pCMod);
        <span class="keywordflow">if</span> (pProcessClass == 0) {
            PyErr_Print();
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ConfigureError&quot;</span>, <span class="stringliteral">&quot;Problem loading python script&quot;</span>);
        }

        PyObject* pProcess = PyObject_GetAttrString(pProcessClass, <span class="stringliteral">&quot;lastProcess&quot;</span>);
        Py_DECREF(pProcessClass);
        <span class="keywordflow">if</span> (pProcess == 0) {
            PyErr_Print();
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ConfigureError&quot;</span>, <span class="stringliteral">&quot;Problem loading python script&quot;</span>);
        }

        <a class="code" href="classldmx_1_1ConfigurePython.html#acc7e183a3417d290890d47476ab50aa8">passname_</a> = stringMember(pProcess, <span class="stringliteral">&quot;passName&quot;</span>);
        eventLimit_ = intMember(pProcess, <span class="stringliteral">&quot;maxEvents&quot;</span>);
        run_ = intMember(pProcess, <span class="stringliteral">&quot;run&quot;</span>);
        <a class="code" href="classldmx_1_1ConfigurePython.html#ab733492c9ebe4dfbe7d57f9b3366156a">histoOutFile_</a> = stringMember(pProcess, <span class="stringliteral">&quot;histogramFile&quot;</span>);

        PyObject* pysequence = PyObject_GetAttrString(pProcess, <span class="stringliteral">&quot;sequence&quot;</span>);
        <span class="keywordflow">if</span> (!PyList_Check(pysequence)) {
            <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;ConfigureError&quot;</span>, <span class="stringliteral">&quot;sequence is not a python list as expected.&quot;</span>);
        }
        <span class="keywordflow">for</span> (Py_ssize_t i = 0; i &lt; PyList_Size(pysequence); i++) {
            PyObject* processor = PyList_GetItem(pysequence, i);
            ProcessorInfo pi;
            pi.classname_ = stringMember(processor, <span class="stringliteral">&quot;className&quot;</span>);
            pi.instancename_ = stringMember(processor, <span class="stringliteral">&quot;instanceName&quot;</span>);

            PyObject* params = PyObject_GetAttrString(processor, <span class="stringliteral">&quot;parameters&quot;</span>);
            <span class="keywordflow">if</span> (params != 0 &amp;&amp; PyDict_Check(params)) {
                PyObject *key(0), *value(0);
                Py_ssize_t pos = 0;

                <span class="keywordflow">while</span> (PyDict_Next(params, &amp;pos, &amp;key, &amp;value)) {
                    std::string skey = PyString_AsString(key);
                    <span class="keywordflow">if</span> (PyInt_Check(value)) {
                        pi.params_.insert(skey, <span class="keywordtype">int</span>(PyInt_AsLong(value)));
                        <span class="comment">//printf(&quot;Int Key: %s\n&quot;,skey.c_str());</span>
                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyFloat_Check(value)) {
                        pi.params_.insert(skey, PyFloat_AsDouble(value));
                        <span class="comment">//printf(&quot;Double Key: %s\n&quot;,skey.c_str());</span>
                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyString_Check(value)) {
                        pi.params_.insert(skey, PyString_AsString(value));
                        <span class="comment">//printf(&quot;String Key: %s\n&quot;,skey.c_str());</span>
                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyList_Check(value)) { <span class="comment">// assume everything is same value as first value</span>
                        <span class="keywordflow">if</span> (PyList_Size(value) &gt; 0) {
                            PyObject* vec0 = PyList_GetItem(value, 0);
                            <span class="keywordflow">if</span> (PyInt_Check(vec0)) {
                                std::vector&lt;int&gt; vals;
                                <span class="keywordflow">for</span> (Py_ssize_t j = 0; j &lt; PyList_Size(value); j++)
                                    vals.push_back(PyInt_AsLong(PyList_GetItem(value, j)));
                                pi.params_.insert(skey, vals);
                                <span class="comment">//printf(&quot;VInt Key: %s\n&quot;,skey.c_str());</span>
                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyFloat_Check(vec0)) {
                                std::vector&lt;double&gt; vals;
                                <span class="keywordflow">for</span> (Py_ssize_t j = 0; j &lt; PyList_Size(value); j++)
                                    vals.push_back(PyFloat_AsDouble(PyList_GetItem(value, j)));
                                pi.params_.insert(skey, vals);
                                <span class="comment">//printf(&quot;VDouble Key: %s\n&quot;,skey.c_str());</span>
                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyString_Check(vec0)) {
                                std::vector&lt;std::string&gt; vals;
                                <span class="keywordflow">for</span> (Py_ssize_t j = 0; j &lt; PyList_Size(value); j++)
                                    vals.push_back(PyString_AsString(PyList_GetItem(value, j)));
                                pi.params_.insert(skey, vals);
                                <span class="comment">//printf(&quot;VString Key: %s\n&quot;,skey.c_str());</span>
                            }
                        }
                    }
                }
            }

            <a class="code" href="classldmx_1_1ConfigurePython.html#a448506b08fdb4551c0051250d28f6127">sequence_</a>.push_back(pi);
        }
        Py_DECREF(pysequence);

        pylist = PyObject_GetAttrString(pProcess, <span class="stringliteral">&quot;keep&quot;</span>);
        <span class="keywordflow">if</span> (!PyList_Check(pylist)) {
            std::cerr &lt;&lt; <span class="stringliteral">&quot;keep is not a python list as expected.\n&quot;</span>;
            <span class="keywordflow">return</span>;
        }
        <span class="keywordflow">for</span> (Py_ssize_t i = 0; i &lt; PyList_Size(pylist); i++) {
            PyObject* elem = PyList_GetItem(pylist, i);
            <a class="code" href="classldmx_1_1ConfigurePython.html#a638ec8a4db7ace29c62e773395b63d36">keepRules_</a>.push_back(PyString_AsString(elem));
        }
        Py_DECREF(pylist);

        pylist = PyObject_GetAttrString(pProcess, <span class="stringliteral">&quot;inputFiles&quot;</span>);
        <span class="keywordflow">if</span> (!PyList_Check(pylist)) {
            std::cerr &lt;&lt; <span class="stringliteral">&quot;inputFiles is not a python list as expected.\n&quot;</span>;
            <span class="keywordflow">return</span>;
        }
        <span class="keywordflow">for</span> (Py_ssize_t i = 0; i &lt; PyList_Size(pylist); i++) {
            PyObject* elem = PyList_GetItem(pylist, i);
            <a class="code" href="classldmx_1_1ConfigurePython.html#a03862dd75f2260a683cd8cb754c0ce1e">inputFiles_</a>.push_back(PyString_AsString(elem));
        }
        Py_DECREF(pylist);

        pylist = PyObject_GetAttrString(pProcess, <span class="stringliteral">&quot;outputFiles&quot;</span>);
        <span class="keywordflow">if</span> (!PyList_Check(pylist)) {
            std::cerr &lt;&lt; <span class="stringliteral">&quot;outputFiles is not a python list as expected.\n&quot;</span>;
            <span class="keywordflow">return</span>;
        }
        <span class="keywordflow">for</span> (Py_ssize_t i = 0; i &lt; PyList_Size(pylist); i++) {
            PyObject* elem = PyList_GetItem(pylist, i);
            <a class="code" href="classldmx_1_1ConfigurePython.html#a9ec35dcf8f1908874a1b784697b250c6">outputFiles_</a>.push_back(PyString_AsString(elem));
        }
        Py_DECREF(pylist);

        pylist = PyObject_GetAttrString(pProcess, <span class="stringliteral">&quot;libraries&quot;</span>);
        <span class="keywordflow">if</span> (!PyList_Check(pylist)) {
            std::cerr &lt;&lt; <span class="stringliteral">&quot;libraries is not a python list as expected.\n&quot;</span>;
            <span class="keywordflow">return</span>;
        }
        <span class="keywordflow">for</span> (Py_ssize_t i = 0; i &lt; PyList_Size(pylist); i++) {
            PyObject* elem = PyList_GetItem(pylist, i);
            <a class="code" href="classldmx_1_1ConfigurePython.html#ac92502918c7289b51e9189f2077ca7c5">libraries_</a>.push_back(PyString_AsString(elem));
        }
        Py_DECREF(pylist);
    }
</pre></div>
</div>
</div>
<a class="anchor" id="a8faf714491e50cdaac51adfea5991ccd"></a><!-- doxytag: member="ldmx::ConfigurePython::~ConfigurePython" ref="a8faf714491e50cdaac51adfea5991ccd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::ConfigurePython::~ConfigurePython </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Class destructor. </p>

<p>Definition at line <a class="el" href="ConfigurePython_8cxx_source.html#l00191">191</a> of file <a class="el" href="ConfigurePython_8cxx_source.html">ConfigurePython.cxx</a>.</p>
<div class="fragment"><pre class="fragment">                                      {
        Py_Finalize();
    }
</pre></div>
</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a16c95925a35f1621496d84f2b9ff271f"></a><!-- doxytag: member="ldmx::ConfigurePython::makeProcess" ref="a16c95925a35f1621496d84f2b9ff271f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classldmx_1_1Process.html">Process</a> * ldmx::ConfigurePython::makeProcess </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a process object based on the python file information </p>

<p>Definition at line <a class="el" href="ConfigurePython_8cxx_source.html#l00195">195</a> of file <a class="el" href="ConfigurePython_8cxx_source.html">ConfigurePython.cxx</a>.</p>

<p>References <a class="el" href="classldmx_1_1Process.html#a0ccf966625e23c3a630c34e86bcd674d">ldmx::Process::addDropKeepRule()</a>, <a class="el" href="classldmx_1_1Process.html#acad5781b242d2eabf3b6af1ae3107d21">ldmx::Process::addFileToProcess()</a>, <a class="el" href="classldmx_1_1Process.html#a5b1d6cba024c0ff342857ba3cc250e9c">ldmx::Process::addOutputFileName()</a>, <a class="el" href="classldmx_1_1Process.html#a9e4a3a7bcff60999ba666b23fb53d38e">ldmx::Process::addToSequence()</a>, <a class="el" href="EventProcessor_8h_source.html#l00059">ldmx::EventProcessor::configure()</a>, <a class="el" href="EventProcessorFactory_8cxx_source.html#l00042">ldmx::EventProcessorFactory::createEventProcessor()</a>, <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, <a class="el" href="EventProcessorFactory_8h_source.html#l00032">ldmx::EventProcessorFactory::getInstance()</a>, <a class="el" href="ConfigurePython_8h_source.html#l00072">histoOutFile_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00057">inputFiles_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00066">keepRules_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00068">libraries_</a>, <a class="el" href="EventProcessorFactory_8cxx_source.html#l00050">ldmx::EventProcessorFactory::loadLibrary()</a>, <a class="el" href="ConfigurePython_8h_source.html#l00070">outputFiles_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00054">passname_</a>, <a class="el" href="ConfigurePython_8h_source.html#l00085">sequence_</a>, <a class="el" href="Process_8h_source.html#l00105">ldmx::Process::setEventLimit()</a>, <a class="el" href="classldmx_1_1Process.html#a9469359cefcd738a9d14c0791a20fbb2">ldmx::Process::setHistogramFileName()</a>, and <a class="el" href="Process_8h_source.html#l00097">ldmx::Process::setRunNumber()</a>.</p>
<div class="fragment"><pre class="fragment">                                          {
        Process* p = <span class="keyword">new</span> Process(<a class="code" href="classldmx_1_1ConfigurePython.html#acc7e183a3417d290890d47476ab50aa8">passname_</a>);

        <span class="keywordflow">for</span> (<span class="keyword">auto</span> lib : <a class="code" href="classldmx_1_1ConfigurePython.html#ac92502918c7289b51e9189f2077ca7c5">libraries_</a>) {
            <a class="code" href="classldmx_1_1EventProcessorFactory.html#a288aa4dd9ba6fb37f13ee78e9054ac83">EventProcessorFactory::getInstance</a>().loadLibrary(lib);
        }

        <span class="keywordflow">for</span> (<span class="keyword">auto</span> proc : <a class="code" href="classldmx_1_1ConfigurePython.html#a448506b08fdb4551c0051250d28f6127">sequence_</a>) {
            EventProcessor* ep = <a class="code" href="classldmx_1_1EventProcessorFactory.html#a288aa4dd9ba6fb37f13ee78e9054ac83">EventProcessorFactory::getInstance</a>().createEventProcessor(proc.classname_, proc.instancename_, *p);
            <span class="keywordflow">if</span> (ep == 0) {
                <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8" title="Utility macro for throwing exceptions, automatically including the necessary file, line, and function information. The user need only supply the exception name and error message.">EXCEPTION_RAISE</a>(<span class="stringliteral">&quot;UnableToCreate&quot;</span>, <span class="stringliteral">&quot;Unable to create instance &#39;&quot;</span> + proc.instancename_ + <span class="stringliteral">&quot;&#39; of class &#39;&quot;</span> + proc.classname_ + <span class="stringliteral">&quot;&#39;&quot;</span>);
            }
            ep-&gt;configure(proc.params_);
            p-&gt;addToSequence(ep);
        }
        <span class="keywordflow">for</span> (<span class="keyword">auto</span> file : <a class="code" href="classldmx_1_1ConfigurePython.html#a03862dd75f2260a683cd8cb754c0ce1e">inputFiles_</a>) {
            p-&gt;addFileToProcess(file);
        }
        <span class="keywordflow">for</span> (<span class="keyword">auto</span> file : <a class="code" href="classldmx_1_1ConfigurePython.html#a9ec35dcf8f1908874a1b784697b250c6">outputFiles_</a>) {
            p-&gt;addOutputFileName(file);
        }
        <span class="keywordflow">for</span> (<span class="keyword">auto</span> rule : <a class="code" href="classldmx_1_1ConfigurePython.html#a638ec8a4db7ace29c62e773395b63d36">keepRules_</a>) {
            p-&gt;addDropKeepRule(rule);
        }
        <span class="keywordflow">if</span> (run_ &gt; 0)
            p-&gt;setRunNumber(run_);
        p-&gt;setEventLimit(eventLimit_);
        p-&gt;setHistogramFileName(<a class="code" href="classldmx_1_1ConfigurePython.html#ab733492c9ebe4dfbe7d57f9b3366156a">histoOutFile_</a>);

        <span class="keywordflow">return</span> p;

    }
</pre></div>
</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ab733492c9ebe4dfbe7d57f9b3366156a"></a><!-- doxytag: member="ldmx::ConfigurePython::histoOutFile_" ref="ab733492c9ebe4dfbe7d57f9b3366156a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classldmx_1_1ConfigurePython.html#ab733492c9ebe4dfbe7d57f9b3366156a">ldmx::ConfigurePython::histoOutFile_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Histogram output file name </p>

<p>Definition at line <a class="el" href="ConfigurePython_8h_source.html#l00072">72</a> of file <a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>.</p>

<p>Referenced by <a class="el" href="ConfigurePython_8cxx_source.html#l00034">ConfigurePython()</a>, and <a class="el" href="ConfigurePython_8cxx_source.html#l00195">makeProcess()</a>.</p>

</div>
</div>
<a class="anchor" id="a03862dd75f2260a683cd8cb754c0ce1e"></a><!-- doxytag: member="ldmx::ConfigurePython::inputFiles_" ref="a03862dd75f2260a683cd8cb754c0ce1e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; <a class="el" href="classldmx_1_1ConfigurePython.html#a03862dd75f2260a683cd8cb754c0ce1e">ldmx::ConfigurePython::inputFiles_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The maximum number of events to process, if provided in python file. The run number to use when generating events (no input file), if provided in python file. List of input ROOT files to process in the job, if provided in python file. </p>

<p>Definition at line <a class="el" href="ConfigurePython_8h_source.html#l00057">57</a> of file <a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>.</p>

<p>Referenced by <a class="el" href="ConfigurePython_8cxx_source.html#l00034">ConfigurePython()</a>, and <a class="el" href="ConfigurePython_8cxx_source.html#l00195">makeProcess()</a>.</p>

</div>
</div>
<a class="anchor" id="a638ec8a4db7ace29c62e773395b63d36"></a><!-- doxytag: member="ldmx::ConfigurePython::keepRules_" ref="a638ec8a4db7ace29c62e773395b63d36" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; <a class="el" href="classldmx_1_1ConfigurePython.html#a638ec8a4db7ace29c62e773395b63d36">ldmx::ConfigurePython::keepRules_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>List of rules for keeping and dropping data products, if provided in python file. </p>

<p>Definition at line <a class="el" href="ConfigurePython_8h_source.html#l00066">66</a> of file <a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>.</p>

<p>Referenced by <a class="el" href="ConfigurePython_8cxx_source.html#l00034">ConfigurePython()</a>, and <a class="el" href="ConfigurePython_8cxx_source.html#l00195">makeProcess()</a>.</p>

</div>
</div>
<a class="anchor" id="ac92502918c7289b51e9189f2077ca7c5"></a><!-- doxytag: member="ldmx::ConfigurePython::libraries_" ref="ac92502918c7289b51e9189f2077ca7c5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; <a class="el" href="classldmx_1_1ConfigurePython.html#ac92502918c7289b51e9189f2077ca7c5">ldmx::ConfigurePython::libraries_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>List of rules for shared libraries to load, if provided in python file. </p>

<p>Definition at line <a class="el" href="ConfigurePython_8h_source.html#l00068">68</a> of file <a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>.</p>

<p>Referenced by <a class="el" href="ConfigurePython_8cxx_source.html#l00034">ConfigurePython()</a>, and <a class="el" href="ConfigurePython_8cxx_source.html#l00195">makeProcess()</a>.</p>

</div>
</div>
<a class="anchor" id="a9ec35dcf8f1908874a1b784697b250c6"></a><!-- doxytag: member="ldmx::ConfigurePython::outputFiles_" ref="a9ec35dcf8f1908874a1b784697b250c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; <a class="el" href="classldmx_1_1ConfigurePython.html#a9ec35dcf8f1908874a1b784697b250c6">ldmx::ConfigurePython::outputFiles_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>List of rules for output ROOT file names, if provided in python file. </p>

<p>Definition at line <a class="el" href="ConfigurePython_8h_source.html#l00070">70</a> of file <a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>.</p>

<p>Referenced by <a class="el" href="ConfigurePython_8cxx_source.html#l00034">ConfigurePython()</a>, and <a class="el" href="ConfigurePython_8cxx_source.html#l00195">makeProcess()</a>.</p>

</div>
</div>
<a class="anchor" id="acc7e183a3417d290890d47476ab50aa8"></a><!-- doxytag: member="ldmx::ConfigurePython::passname_" ref="acc7e183a3417d290890d47476ab50aa8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classldmx_1_1ConfigurePython.html#acc7e183a3417d290890d47476ab50aa8">ldmx::ConfigurePython::passname_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The label for this processing pass. </p>

<p>Definition at line <a class="el" href="ConfigurePython_8h_source.html#l00054">54</a> of file <a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>.</p>

<p>Referenced by <a class="el" href="ConfigurePython_8cxx_source.html#l00034">ConfigurePython()</a>, and <a class="el" href="ConfigurePython_8cxx_source.html#l00195">makeProcess()</a>.</p>

</div>
</div>
<a class="anchor" id="a448506b08fdb4551c0051250d28f6127"></a><!-- doxytag: member="ldmx::ConfigurePython::sequence_" ref="a448506b08fdb4551c0051250d28f6127" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structldmx_1_1ConfigurePython_1_1ProcessorInfo.html">ProcessorInfo</a>&gt; <a class="el" href="classldmx_1_1ConfigurePython.html#a448506b08fdb4551c0051250d28f6127">ldmx::ConfigurePython::sequence_</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The sequence of <a class="el" href="classldmx_1_1EventProcessor.html" title="Base class for all event processing components.">EventProcessor</a> objects to be executed in order. </p>

<p>Definition at line <a class="el" href="ConfigurePython_8h_source.html#l00085">85</a> of file <a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a>.</p>

<p>Referenced by <a class="el" href="ConfigurePython_8cxx_source.html#l00034">ConfigurePython()</a>, and <a class="el" href="ConfigurePython_8cxx_source.html#l00195">makeProcess()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Framework/include/Framework/<a class="el" href="ConfigurePython_8h_source.html">ConfigurePython.h</a></li>
<li>Framework/src/<a class="el" href="ConfigurePython_8cxx_source.html">ConfigurePython.cxx</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
